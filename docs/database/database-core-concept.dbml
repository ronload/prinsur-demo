Project user_module {
    database_type: 'PostgreSQL'
    Note: 'æ ¸å¿ƒæ¦‚å¿µåœ– - åƒ…é¡¯ç¤ºä¸»è¦æ¥­å‹™å¯¦é«”èˆ‡é—œä¿‚'
}

//// ðŸ“Œ ç”¨æˆ¶é ˜åŸŸ
Enum user_role {
    admin
    manager
    staff
    user
}

Table users [headercolor: #3498db, note: 'ç³»çµ±ç”¨æˆ¶ä¸»è¡¨'] {
    id         int         [pk, increment]
    email      text        [not null, unique]
    name       text        [not null]
    role       user_role   [not null, default: `user`]
    created_at timestamptz [not null, default: `now()`]
    updated_at timestamptz [not null, default: `now()`]
}

Table customer_profiles [headercolor: #3498db, note: 'æ¶ˆè²»è€…æª”æ¡ˆ'] {
    user_id    int         [pk]
    age        int
    gender     gender
    weight_kg  numeric(5, 2)
    height_cm  numeric(5, 2)
    created_at timestamptz [default: `now()`]
    updated_at timestamptz [default: `now()`]
}
Ref: customer_profiles.user_id - users.id

Table agent_profiles [headercolor: #3498db, note: 'æ¥­å‹™å“¡æª”æ¡ˆ'] {
    user_id        int     [pk]
    license_number varchar [unique, not null]
    company_id     int
    position       varchar
    created_at     timestamptz [default: `now()`]
    updated_at     timestamptz [default: `now()`]
}
Ref: agent_profiles.user_id - users.id

//// ðŸ“Œ ä¿éšªå…¬å¸èˆ‡å•†å“
Table companies [headercolor: #f39c12, note: 'ä¿éšªå…¬å¸'] {
    id         int     [pk, increment]
    name       varchar [unique, not null]
    created_at timestamptz [default: `now()`]
    updated_at timestamptz [default: `now()`]
}
Ref: agent_profiles.company_id > companies.id

Enum insurance_categories {
    life
    health
    accident
    travel
    vehicle
    property
}

Table insurances [headercolor: #f39c12, note: 'ä¿éšªå•†å“'] {
    id         int                  [pk, increment]
    company_id int                  [not null]
    category   insurance_categories [not null]
    name       varchar              [not null]
    created_at timestamptz          [default: `now()`]
    updated_at timestamptz          [default: `now()`]
}
Ref: insurances.company_id > companies.id

//// ðŸ“Œ ä¿å–®èˆ‡ç†è³ 
Table policy_enrollments [headercolor: #127859, note: 'ä¿å–®æŠ•ä¿è¨˜éŒ„'] {
    id            int  [pk, increment]
    customer_id   int  [not null]
    agent_id      int  [not null]
    insurance_id  int  [not null]
    policy_number text [not null, unique]
    created_at    timestamptz [default: `now()`]
    updated_at    timestamptz [default: `now()`]
}
Ref: policy_enrollments.customer_id > customer_profiles.user_id [delete: restrict]
Ref: policy_enrollments.agent_id > agent_profiles.user_id [delete: restrict]
Ref: policy_enrollments.insurance_id > insurances.id [delete: restrict]

Enum claim_status {
    pending
    approved
    rejected
    processing
}

Table claims [headercolor: #127859, note: 'ç†è³ ç”³è«‹'] {
    id                   int            [pk, increment]
    policy_enrollment_id int            [not null]
    status               claim_status
    amount               numeric(12, 2)
    submit_date          timestamptz
    created_at           timestamptz    [default: `now()`]
    updated_at           timestamptz    [default: `now()`]
}
Ref: claims.policy_enrollment_id - policy_enrollments.id

//// ðŸ“Œ ç³»çµ±åŠŸèƒ½
Table notifications [headercolor: #A23456, note: 'ç³»çµ±é€šçŸ¥'] {
    id      int     [pk, increment]
    user_id int     [not null]
    title   text    [not null]
    payload jsonb   [not null]
    sent_at timestamptz [not null, default: `now()`]
    read_at timestamptz
}
Ref: notifications.user_id > users.id

Enum gender {
    male
    female
}
