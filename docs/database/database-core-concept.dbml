Project user_module {
    database_type: 'PostgreSQL'
    Note: '核心概念圖 - 僅顯示主要業務實體與關係'
}

//// 📌 用戶領域
Enum user_role {
    admin
    manager
    staff
    user
}

Table users [headercolor: #3498db, note: '系統用戶主表'] {
    id         int         [pk, increment]
    email      text        [not null, unique]
    name       text        [not null]
    role       user_role   [not null, default: `user`]
    created_at timestamptz [not null, default: `now()`]
    updated_at timestamptz [not null, default: `now()`]
}

Table customer_profiles [headercolor: #3498db, note: '消費者檔案'] {
    user_id    int         [pk]
    age        int
    gender     gender
    weight_kg  numeric(5, 2)
    height_cm  numeric(5, 2)
    created_at timestamptz [default: `now()`]
    updated_at timestamptz [default: `now()`]
}
Ref: customer_profiles.user_id - users.id

Table agent_profiles [headercolor: #3498db, note: '業務員檔案'] {
    user_id        int     [pk]
    license_number varchar [unique, not null]
    company_id     int
    position       varchar
    created_at     timestamptz [default: `now()`]
    updated_at     timestamptz [default: `now()`]
}
Ref: agent_profiles.user_id - users.id

//// 📌 保險公司與商品
Table companies [headercolor: #f39c12, note: '保險公司'] {
    id         int     [pk, increment]
    name       varchar [unique, not null]
    created_at timestamptz [default: `now()`]
    updated_at timestamptz [default: `now()`]
}
Ref: agent_profiles.company_id > companies.id

Enum insurance_categories {
    life
    health
    accident
    travel
    vehicle
    property
}

Table insurances [headercolor: #f39c12, note: '保險商品'] {
    id         int                  [pk, increment]
    company_id int                  [not null]
    category   insurance_categories [not null]
    name       varchar              [not null]
    created_at timestamptz          [default: `now()`]
    updated_at timestamptz          [default: `now()`]
}
Ref: insurances.company_id > companies.id

//// 📌 保單與理賠
Table policy_enrollments [headercolor: #127859, note: '保單投保記錄'] {
    id            int  [pk, increment]
    customer_id   int  [not null]
    agent_id      int  [not null]
    insurance_id  int  [not null]
    policy_number text [not null, unique]
    created_at    timestamptz [default: `now()`]
    updated_at    timestamptz [default: `now()`]
}
Ref: policy_enrollments.customer_id > customer_profiles.user_id [delete: restrict]
Ref: policy_enrollments.agent_id > agent_profiles.user_id [delete: restrict]
Ref: policy_enrollments.insurance_id > insurances.id [delete: restrict]

Enum claim_status {
    pending
    approved
    rejected
    processing
}

Table claims [headercolor: #127859, note: '理賠申請'] {
    id                   int            [pk, increment]
    policy_enrollment_id int            [not null]
    status               claim_status
    amount               numeric(12, 2)
    submit_date          timestamptz
    created_at           timestamptz    [default: `now()`]
    updated_at           timestamptz    [default: `now()`]
}
Ref: claims.policy_enrollment_id - policy_enrollments.id

//// 📌 系統功能
Table notifications [headercolor: #A23456, note: '系統通知'] {
    id      int     [pk, increment]
    user_id int     [not null]
    title   text    [not null]
    payload jsonb   [not null]
    sent_at timestamptz [not null, default: `now()`]
    read_at timestamptz
}
Ref: notifications.user_id > users.id

Enum gender {
    male
    female
}
